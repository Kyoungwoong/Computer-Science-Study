# 네트워크 총정리

---

## 1) 어플리케이션 계층 (Application)

- **목적**: 사용자에 가까운 레벨에서 **데이터 교환 규약** 정의 (예: HTTP, DNS)
- **모델**: **클라이언트–서버** 구조 (클라이언트 요청 → 서버 응답)
- **HTTP 주요 특징**

  - **Stateless**: 각 요청 독립 처리(상태 유지는 **쿠키/세션/토큰**)
  - **요소**: Method · URL · Header · Body · Status Code
  - **주요 메서드**: `GET`(조회) / `POST`(생성·처리) / `PUT`(전체 교체) / `PATCH`(부분 수정) / `DELETE`(삭제)
  - **상태 코드 범주**: 2xx 성공 / 3xx 리다이렉트 / 4xx 클라이언트 오류 / 5xx 서버 오류

- **DNS 핵심**: **도메인 ↔ IP 매핑**. 로컬 DNS → 루트/TLD/권한 DNS 순으로 질의하여 최종 IP 획득

---

## 2) 전송 계층 (Transport)

- **목적**: **End-to-End(프로세스 간)** 데이터 전달의 신뢰성·순서·오류 제어
- **포트 기반 다중화**: 여러 애플리케이션 트래픽을 **포트 번호**로 구분(다중화/역다중화)
- **UDP vs TCP**

| 구분    | 연결        | 신뢰성/순서       | 지연/오버헤드 | 대표 사용처                |
| ------- | ----------- | ----------------- | ------------- | -------------------------- |
| **UDP** | 비연결      | 보장 없음         | 낮음(빠름)    | 스트리밍, 실시간 통신, DNS |
| **TCP** | 연결(3-way) | 보장(재전송·순서) | 높음(안정)    | 웹/파일전송/일반 API       |

- **TCP 핵심 동작**

  - **연결 설정**: 3-way handshake
  - **신뢰성**: 순서 보장, 손실 시 재전송
  - **흐름/혼잡 제어**: 수신자·네트워크 상황에 맞춰 전송량 자동 조절

- **키워드**: 세그먼트(Segment), 포트(Port), RTT(왕복 지연)

---

## 3) 네트워크 계층 (Network)

- **목적**: **호스트 간 패킷(IP 데이터그램)** 전달 (인터넷은 **Best-effort**: 전달/순서/지연 보장 없음)
- **데이터 평면 vs 제어 평면**

  - **포워딩(데이터 평면)**: 최장 프리픽스 일치(**LPM**)로 출력 포트 즉시 결정
  - **라우팅(제어 평면)**: 네트워크 전반의 **경로 계산** 및 **포워딩 테이블 구성**

- **IP 주소/설계**

  - 인터페이스 단위로 IP 부여, **CIDR**(`a.b.c.d/x`)로 유연한 주소/경로 요약
  - **브로드캐스트**(IPv4), **서브넷 마스크**로 네트워크 경계 정의
  - **DHCP**: IP·게이트웨이·DNS 등 **구성 정보를 자동 임대**

- **NAT 핵심**: 내부 **사설 IP ↔ 공인 IP:포트** 매핑(주소 절약·내부 은닉) — 인바운드 서버 운영 시 포트포워딩 등 필요
- **단편화(IPv4)**: MTU 초과 패킷을 조각화(IPv6는 끝단만 처리)
- **라우팅 프로토콜 개요**

  - **IGP**(AS 내부): RIP(단순·홉수) / **OSPF**(링크상태·빠른 수렴)
  - **EGP**(AS 간): **BGP**(정책 기반, 인터넷 표준)

- **IPv4 vs IPv6 **: 128비트 주소로 공간 확대, 단순화된 기본 헤더 + 확장 헤더

---

## 링크 계층

---

### 링크계층 개요

---

- **주소화**: MAC 주소로 같은 네트워크 안의 주소를 구분한다.
- **스위치**: MAC 주소를 학습, 관리하는 역할을 한다.
- **Multiple Access Control**: 공유 매체에서 누가 언제 프레임을 보낼지 결정
- 대표적으로 CSMA/CD, CSMA/CA 가 있다.
- **프레이밍**: 링크계층은 IP 패킷을 프레임 단위로 캡슐화한다.
- **오류검출**: 프레임 전송 시 오류 여부를 확인하는 기능

---

### 주소화

---

#### 주소화 개요

- 링크계층은 같은 네트워크 안에서 데이터를 주고받는 역할을 한다.
- 이때 장치들을 식별하기 위해 MAC 주소를 사용한다.

#### MAC 주소의 구조

- 크기: 48비트(6바이트)
- 표기법: `AA:BB:CC:DD:EE:FF` (16진수 6쌍)

#### MAC 주소 종류

- **Unicast 주소**: 특정 1대 장치에게 전송
- **Broadcast 주소**: 모든 장치에게 전송 (`FF:FF:FF:FF:FF:FF`)
- **Multicast 주소**: 특정 그룹에만 전송 (IPv4의 경우 `01:00:5E` 로 시작)

#### MAC 주소 vs IP 주소, 그리고 ARP

- **MAC 주소**

  - 링크계층에서 사용하는 하드웨어 주소
  - 네트워크 카드(NIC)에 부여
  - 같은 네트워크 안에서만 유효하다

- **IP 주소**

  - 네트워크 계층에서 사용하는 논리 주소
  - 네트워크 부분 + 호스트 부분으로 구성
  - 인터넷 전체 범위에서 종단 간(End-to-End) 통신을 위해 사용

- **ARP (Address Resolution Protocol)**

  - 상대방의 IP 주소 → MAC 주소로 변환하는 프로토콜
  - 동작 방식

    1. 송신자가 브로드캐스트로 “이 IP 가진 장치 누구세요?” 요청
    2. 대상 장치가 자신의 MAC 주소를 유니캐스트로 응답
    3. 결과를 ARP 캐시에 저장해 이후 재사용

---

### 스위치의 MAC 주소 관리

1. **학습 (Learning)**

   - 스위치가 프레임이 들어온 포트번호와 출발지 MAC 주소를 테이블에 기록

2. **포워딩/필터링 (Forwarding/Filtering)**

   - 수신한 프레임의 목적지 MAC을 테이블에서 확인

     - 목적지 MAC 있음 → 해당 포트로만 전송
     - 목적지 MAC 모름 → 모든 포트로 브로드캐스트처럼 전송

---

### MAC 프로토콜

---

#### MAC 프로토콜 개요

- **MAC (Medium Access Control) 프로토콜**은
  여러 장치가 **하나의 전송 매체(Medium)** 를 공유할 때 **누가 언제 전송할지 결정하는 규칙**.
- 필요 이유: 충돌(Collision) 방지 및 효율적인 매체 사용

---

#### CSMA (Carrier Sense Multiple Access)

- **Carrier Sense**: 보내기 전에 매체가 사용 중인지 확인

  - NIC가 전송 매체를 계속 감시한다.

    - **유선**: 케이블의 전압·신호 레벨을 확인
    - **무선**: 전파 세기를 확인

- **Multiple Access**: 여러 장치가 매체를 공동 사용
- **원리**: **“듣고, 비면 전송한다”**

---

#### CSMA/CD (Collision Detection, 유선 Ethernet)

1. 매체를 듣는다 → 비면 송신
2. 동시에 송신 시 충돌 발생
3. 충돌 감지 → 즉시 전송 중단
4. **랜덤 대기(backoff)** 후 재전송

“부딪히면 멈추고, 기다렸다가 다시 보내라”

---

#### CSMA/CA (Collision Avoidance, 무선 LAN)

1. 매체를 듣는다 → 비면 바로 송신하지 않고 대기
2. **랜덤 백오프 후 송신**
3. 수신 측이 **ACK 프레임**을 보내면 성공 확인 (CSMA/CA 에서는 무선이라서 신호 변화로 하기 힘들다!)
4. 필요 시 **RTS/CTS**(예약)으로 숨은 단말 문제 해결

“부딪히기 전에 조심스럽게 보내고, ACK로 확인한다”
